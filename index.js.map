{"version":3,"file":"index.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst myApiKey = '14990931-ad4ebe1f82b0ac4449d9d4609';\nconst form = document.querySelector('.form');\nconst bottomOfGallery = document.querySelector('.bottomOfGallery');\nconst gallery = document.querySelector('.gallery');\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\n// Controls the page number\nlet page = 1;\n// Controls the number of images in the gallery\nlet perPage = 40;\n\nform.addEventListener('submit', async evt => {\n  try {\n    gallery.innerHTML = '';\n    bottomOfGallery.innerHTML = '';\n    page = 1;\n    evt.preventDefault();\n    gallery.insertAdjacentHTML('beforeend', '<span class=\"loader\"></span>');\n    const inputField = form.elements.searchInput.value.trim();\n\n    if (inputField.length === 0) {\n      gallery.innerHTML = '';\n      return iziToast.error({\n        message: 'Empty field',\n      });\n    }\n\n    const images = await fetchImages(inputField);\n    const { hits } = images;\n\n    if (hits.length === 0) {\n      document.querySelector('.loader').remove();\n      return iziToast.error({\n        message:\n          '‚ùå Sorry, there are no images matching your search query. Please try again!',\n      });\n    }\n\n    renderImages(hits);\n    bottomOfGallery.insertAdjacentHTML(\n      'beforeend',\n      '<button name=\"loadMoreBtn\">Load more</button>'\n    );\n    return addMoreImages(inputField);\n  } catch (error) {\n    gallery.innerHTML = '';\n    iziToast.error({ message: `Request failed: ${error.message}` });\n  } finally {\n    form.reset();\n  }\n});\n\nasync function fetchImages(inputField) {\n  const response = await axios.get(`https://pixabay.com/api/`, {\n    params: {\n      key: myApiKey,\n      q: inputField,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: false,\n      per_page: perPage,\n      page: page,\n    },\n  });\n  return response.data;\n}\n\nfunction renderImages(hits) {\n  document.querySelector('.loader').remove();\n  const markup = hits\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n          <div class=\"img-data\">\n            <div class=\"data-values\">Likes <p>${likes}</p></div>\n            <div class=\"data-values\">Views <p>${views}</p></div>\n            <div class=\"data-values\">Comments <p>${comments}</p></div>\n            <div class=\"data-values\">Downloads <p>${downloads}</p></div>\n          </div>\n        </a>\n      </li>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nasync function addMoreImages(inputField) {\n  const loadMoreBtn = document.querySelector('button[name=\"loadMoreBtn\"]');\n\n  loadMoreBtn.addEventListener('click', async () => {\n    try {\n      bottomOfGallery.insertAdjacentHTML(\n        'beforeend',\n        '<span class=\"loader\"></span>'\n      );\n      page += 1;\n\n      const images = await fetchImages(inputField);\n      const { hits, totalHits } = images;\n      const totalPages = Math.ceil(totalHits / perPage);\n      if (page > totalPages) {\n        bottomOfGallery.innerHTML = '';\n        return iziToast.info({\n          position: 'topRight',\n          message: \"We're sorry, but you've reached the end of search results.\",\n        });\n      }\n\n      renderImages(hits);\n\n      let elem = document.querySelector('.gallery-item');\n      let rect = elem.getBoundingClientRect();\n      const { width } = rect;\n      window.scrollBy({ top: width * 2, behavior: 'smooth' });\n    } catch (error) {\n      gallery.innerHTML = '';\n      iziToast.error({ message: `Request failed: ${error.message}` });\n    }\n  });\n}\n"],"names":["myApiKey","form","bottomOfGallery","gallery","lightbox","SimpleLightbox","page","perPage","evt","inputField","iziToast","images","fetchImages","hits","renderImages","addMoreImages","error","axios","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","totalHits","totalPages","rect","width"],"mappings":"wyBAQA,MAAMA,EAAW,qCACXC,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAkB,SAAS,cAAc,kBAAkB,EAC3DC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,gBAAiB,SACjB,aAAc,GAChB,CAAC,EAGD,IAAIC,EAAO,EAEPC,EAAU,GAEdN,EAAK,iBAAiB,SAAU,MAAMO,GAAO,CAC3C,GAAI,CACFL,EAAQ,UAAY,GACpBD,EAAgB,UAAY,GAC5BI,EAAO,EACPE,EAAI,eAAc,EAClBL,EAAQ,mBAAmB,YAAa,8BAA8B,EACtE,MAAMM,EAAaR,EAAK,SAAS,YAAY,MAAM,KAAI,EAEvD,GAAIQ,EAAW,SAAW,EACxB,OAAAN,EAAQ,UAAY,GACbO,EAAS,MAAM,CACpB,QAAS,aACjB,CAAO,EAGH,MAAMC,EAAS,MAAMC,EAAYH,CAAU,EACrC,CAAE,KAAAI,CAAI,EAAKF,EAEjB,OAAIE,EAAK,SAAW,GAClB,SAAS,cAAc,SAAS,EAAE,OAAM,EACjCH,EAAS,MAAM,CACpB,QACE,4EACV,CAAO,IAGHI,EAAaD,CAAI,EACjBX,EAAgB,mBACd,YACA,+CACN,EACWa,EAAcN,CAAU,EACjC,OAASO,EAAO,CACdb,EAAQ,UAAY,GACpBO,EAAS,MAAM,CAAE,QAAS,mBAAmBM,EAAM,OAAO,GAAI,CAChE,QAAC,CACCf,EAAK,MAAK,CACZ,CACF,CAAC,EAED,eAAeW,EAAYH,EAAY,CAYrC,OAXiB,MAAMQ,EAAM,IAAI,2BAA4B,CAC3D,OAAQ,CACN,IAAKjB,EACL,EAAGS,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMD,CACZ,CACA,CAAG,GACe,IAClB,CAEA,SAASQ,EAAaD,EAAM,CAC1B,SAAS,cAAc,SAAS,EAAE,OAAM,EACxC,MAAMK,EAASL,EACZ,IACC,CAAC,CACC,aAAAM,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAY;AAAA;AAAA,wCAE4BL,CAAa;AAAA;AAAA;AAAA,mBAGlCD,CAAY;AAAA,mBACZE,CAAI;AAAA;AAAA;AAAA,gDAGyBC,CAAK;AAAA,gDACLC,CAAK;AAAA,mDACFC,CAAQ;AAAA,oDACPC,CAAS;AAAA;AAAA;AAAA,YAI7D,EACK,KAAK,EAAE,EACVtB,EAAQ,mBAAmB,YAAae,CAAM,EAC9Cd,EAAS,QAAO,CAClB,CAEA,eAAeW,EAAcN,EAAY,CACnB,SAAS,cAAc,4BAA4B,EAE3D,iBAAiB,QAAS,SAAY,CAChD,GAAI,CACFP,EAAgB,mBACd,YACA,8BACR,EACMI,GAAQ,EAER,MAAMK,EAAS,MAAMC,EAAYH,CAAU,EACrC,CAAE,KAAAI,EAAM,UAAAa,CAAS,EAAKf,EACtBgB,EAAa,KAAK,KAAKD,EAAYnB,CAAO,EAChD,GAAID,EAAOqB,EACT,OAAAzB,EAAgB,UAAY,GACrBQ,EAAS,KAAK,CACnB,SAAU,WACV,QAAS,4DACnB,CAAS,EAGHI,EAAaD,CAAI,EAGjB,IAAIe,EADO,SAAS,cAAc,eAAe,EACjC,sBAAqB,EACrC,KAAM,CAAE,MAAAC,CAAK,EAAKD,EAClB,OAAO,SAAS,CAAE,IAAKC,EAAQ,EAAG,SAAU,SAAU,CACxD,OAASb,EAAO,CACdb,EAAQ,UAAY,GACpBO,EAAS,MAAM,CAAE,QAAS,mBAAmBM,EAAM,OAAO,GAAI,CAChE,CACF,CAAC,CACH"}